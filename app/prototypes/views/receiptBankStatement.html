<div class="app-container">
  <!-- ko widget: {kind:'productNavigation'}--><!--/ko-->
  <div class="app-main">
    <div class="app-header">
      <!-- ko widget: {kind:'globalHeader'}--><!--/ko-->
    </div>
    <div class="app-page-container"> 
      <div class="app-page app-list">

        <div class="app-page-masthead app-page__header">

          <div class="app-page-masthead__titlebar"> 
            <div class="app-page-masthead__titlebar-left"> 
              <h2 class="app-page-masthead__titlebar-title">
                Receipting bank statement 
                <small><i class="icon-file-text2"></i> <strong>example_bank_statement.csv</strong> imported 2nd June.</small>
              </h2>
            </div>
            <div class="app-page-masthead__titlebar-right">
              <div>
                <label class="branch-data-select__label" for="branch-data-select">Showing data from </label>
              </div>
              <div>
                <select id="branch-data-select" class="form-control">
                  <option>All branches</option>
                  <option>Swansea branch</option>
                  <option>Cardiff branch</option>
                  <option>Newport branch</option>
                  <option>Pontpandy branch</option>
                </select>
              </div>
            </div>
          </div>
          
        </div>
        <div class="app-page__content app-page__list app-bankStatementReceipt">
          
          <div class="app-page-list__aside list-aside grid__item">
            <div class="list-aside__header">
              <h4>Imported statement</h4>
            </div>
            <div class="list-aside__items  bank-statement-items">
              <ul class="list-group">
                <li class="list-group-item list-group-item-warning">Auto-allocated items <button class="btn btn-xs btn-success" data-bind="click:confirmAllAutoAllocated">Confirm these receipts</button><span class="badge badge-warning">12</span></li>
                <li class="list-group-item list-group-item-danger">Unallocated items <span class="badge">4</span></li>
                <li class="list-group-item list-group-item-success">Confirmed items <span class="badge">12</span></li>
              </ul>
              <table class="table table-hover">
                <tbody data-bind="foreach: bankStatementData()">
                  <tr class="list-aside-item" data-bind="click:$parent.selectItem.bind($parent), css:{active: (reference==($parent.selectedItem() ? $parent.selectedItem().reference : '')), success: status() == 'confirmed', warning: status() == 'auto-allocated', danger: status() == 'unallocated'}">
                    <td>
                        <div class="list-lead">Item <span data-bind="text: ($index() + 1)"></span></div>
                        <div class="list-lead" data-bind="text:'£' + amount.toLocaleString('en-UK', {style:'currency', currency:'GBP'})"></div>
                        <div><i data-bind="css:{'icon-magic-wand' : status() == 'auto-allocated', 'icon-checkmark' : status() == 'confirmed', 'icon-question5' : status() == 'unallocated' }"></i> <span  data-bind="text:status"></span></div>
                    </td>
                    <td>
                        <br/>
                        <div class="list-lead" data-bind="text:reference"></div>
                        <div data-bind="text:date"></div>
                    </td>
                    <!--<td><button class="btn btn-default btn-xs" data-bind="click:$parent.removeReceipt.bind($parent)">remove</button></td>-->
                  </tr>
                </tbody>
              </table>
              
              
                <!-- Modal -->
                <div class="modal fade" id="process-receipts-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                  <div class="modal-dialog" role="document">
                    <div class="modal-content ">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">Process receipts</h4>
                      </div>
                      <div class="modal-body text-center" data-bind="css: {'alert-warning': (receiptsProcessingState() == processEnum.notStarted), 'alert-success': (receiptsProcessingState() == processEnum.completed)}">
                        <!-- ko if:receiptsProcessingState() == processEnum.notStarted -->
                        <p><i class="icon-warning icon"></i></p>
                        <p>Are you sure you want to process these <span data-bind="text: confirmedItemCount()"></span> receipts?</p>
                        <p><strong>You cannot undo this once processed!</strong> </p>
                        <!-- /ko -->

                        <!-- ko if:receiptsProcessingState() == processEnum.started -->
                        <p>Processing...</p>
                        <!-- /ko -->

                        
                        <!-- ko if:receiptsProcessingState() == processEnum.completed -->
                        <p>Completed!</p>
                        <!-- /ko -->
                      </div>
                      <div class="modal-footer">
                        <!-- ko if:receiptsProcessingState() == processEnum.notStarted -->
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-success" data-bind="click: confirmProcessing">Proceed</button>
                        <!-- /ko -->

                        <!-- ko if:receiptsProcessingState() == processEnum.started -->
                        <!-- /ko -->

                        
                        <!-- ko if:receiptsProcessingState() == processEnum.completed -->
                        <button type="button" class="btn btn-default" data-dismiss="modal">Done</button>
                        <!-- /ko -->
                        
                      </div>
                    </div>
                  </div>
                </div>
              <!-- /ko -->
            </div>
            <div class="list-aside__footer grid grid--padded-sm">
              <div class="grid__item">
                <button class="btn btn-default btn-lg" data-bind="click: saveReceipts">Save</button>
              </div>
              <div class="grid__item">
                <button class="btn btn-success grid__item btn-lg" data-bind="click: processReceipts, css: {disabled: processReceiptsDisabled()}">Process receipts</button>
              </div>
            </div>
          </div>
          <div class="app-page-list__list-container">
            <div class="app-page-list__header">
              <h4>Matched expected items</h4>
              <!--<div class="well well-sm" data-bind="if: selectedItem">
                  Searching for receipt reference: <strong data-bind="text:selectedItem().reference"></strong>, 
                  Amount: £<strong data-bind="text:selectedItem().amount"></strong>,
                  Date: <strong data-bind="text:selectedItem().date"></strong>
              </div>-->

              <div class="app-page-list__search grid grid--padded-sm">
                <form class="form-inline grid__item grid__item--fill">
                  <div class="form-group">
                    <div class="input-group">
                      <input type="search" class="form-control" id="list-search" style="width:300px" placeholder="Payment ref or amount etc." data-bind="textInput:searchText"/>
                      <span class="input-group-addon" id="basic-addon1"><i class="icon-search2"></i></span>
                    </div>
                    <div class="btn-group" data-bind="if: selectedItem">
                      <button type="button" class="btn btn-default" data-bind="css:{active:searchByRef}, click:function(){searchByRef(!searchByRef());}">By ref: <strong data-bind="text:selectedItem().reference"></strong></button>
                      <button type="button" class="btn btn-default" data-bind="css:{active:searchByAmount}, click:function(){searchByAmount(!searchByAmount());}">By amount: <strong data-bind="text:'£' + selectedItem().amount.toLocaleString('en-UK', {style:'currency', currency:'GBP'})"></strong></button>
                      <button type="button" class="btn btn-default" data-bind="css:{active:searchByDate}, click:function(){searchByDate(!searchByDate());}">By date: <strong data-bind="text: selectedItem().date"></strong></button>
                    </div>
                  </div>
                </form>
                <div class="app-page-list__filters grid__item">
                  <!--<button class="btn btn-default" data-bind="click:openUploadBankStatementDialog">Upload bank statement</button>-->

                  <!-- upload bank statement modal -->
                  <div class="modal fade" id="upload-bank-statement-modal" tabindex="-1" role="dialog" aria-labelledby="upload">
                    <div class="modal-dialog" role="document">
                      <div class="modal-content ">
                        <div class="modal-header">
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                          <h4 class="modal-title" id="myModalLabel">Upload your bank statement</h4>
                        </div>
                        <div class="modal-body text-center">
                          <!-- ko if: uploadFileProcessingState() == processEnum.notStarted -->
                          <button class="btn btn-primary btn-lg" data-bind="click: selectFile">Select file</button>
                          <!-- /ko -->
                          <!-- ko if: uploadFileProcessingState() == processEnum.started -->
                            uploading file...
                          <!-- /ko -->
                          <!-- ko if: uploadFileProcessingState() == processEnum.completed-->
                            <div class="alert alert-success"><i class="icon-checkmark"></i> File <strong>example_bank_statement.csv</strong> uploaded</div>
                          <!-- /ko -->
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                          <button type="button" class="btn btn-success" data-bind="css: {disabled: (uploadFileProcessingState() != processEnum.completed)}, click: setSelectedBankStatementMode">Proceed</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- /modal -->


                </div>
                <div class="app-page-default grid__item">
                  <!--<button class="btn btn-default">Filters <i class="icon-plus2"></i></button>-->
                </div>
              </div>
            </div>

            <div class="app-page-list__list">
              <div class="table-container"></div>
              <table id="main-table" class="display dataTable table table-hover table-striped" cellspacing="0" role="grid" aria-describedby="example_info">
                <thead>
                  <tr role="row">
                    <th rowspan="2" class="sorting_asc" tabindex="0">Reference</th>
                    <th rowspan="2" class="sorting" tabindex="0" style="min-width:100px">Owed by</th>
                    <th rowspan="2" class="sorting" tabindex="0" style="min-width:50px">Type</th>
                    <th rowspan="2" class="sorting" tabindex="0" style="min-width:150px">Regarding</th>
                    <th rowspan="2" class="sorting" tabindex="0" style="min-width:70px">Due on</th>
                    <th rowspan="2" class="sorting" tabindex="0" style="min-width:100px">Pay to</th>
                    <th rowspan="1" colspan="2">Amounts (£)</th>
                    <th rowspan="2" class="sorting" tabindex="0" rowspan="1" colspan="1" style="min-width:200px">Allocate to item</th>
                    <th rowspan="2" class="sorting" tabindex="0" width="30" style="min-width:50px">Notes</th>
                  </tr>
                  <tr>

                    <th class="sorting_asc th--sub" tabindex="0" rowspan="1" colspan="1" style="min-width:50px">Total</th>
                    <th class="sorting th--sub" tabindex="0" rowspan="1" colspan="1" style="min-width:50px">Bal</th>
                  </tr>
                </thead>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
  
</div>